<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
	    <link rel="stylesheet" type="text/css" href="bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="style.css">
		<title>IDE Project 2</title>
		<script type="text/javascript" src="d3/d3.js"></script>
	</head>
	<body>
		<h1>Project 1 in IDE</h1>
	  	<div>
	  		<table class="names">
		  		<tr>
		  			<td>Eduards Klavins</td>
		  			<td>Ehsan Khaveh</td>
		  			<td>Olugbenga Oti</td>
		  		</tr>
	  		</table>
	  	</div>

	    <div class="container">
        <div class="jumbotron">
		 	<h2 id="plot1title">Temperature changes during last 100 years in Copenhagen</h2>
 			<svg id="visualisation1" width="1000" height="500"></svg>
        </div>
    </div>

	</body>
	<!-- Append JS source here -->
	<script src="jscode.js"></script>
	<script type="text/javascript">

		// Read in the data from the file called "dataset.csv"
		d3.csv("dataset.csv", function(error,dataset) {

			if (error){

				console.log(error);
			} else {
				// initialize data storage
				var data = [];
				// initialize axis ranges
				var xmin = 0;
				var xmax = 0;
				var ymin = 0;
				var ymax = 0;

				//assign values from CSV by looping over 
				for (var i = 0; i < dataset.length; i++) {

					var instance = {};
					instance["year"] = dataset[i]["YEAR"];
					instance["temperature"] = parseFloat(dataset[i]["metANN"]);
					data.push(instance);

					// initialize axis ranges
					if (i === 0) {
						var xmin = instance["year"];
						var xmax = instance["year"];
						var ymin = instance["temperature"];
						var ymax = instance["temperature"];
					};

					if (instance["year"] > xmax) {
						xmax = instance["year"];
					};
					if(instance["year"] < xmin) {
						xmin = instance["year"];
					};
					if(instance["temperature"]>ymax){
						ymax = instance["temperature"];
					};
					if(instance["temperature"] < ymin){
						ymin = instance["temperature"];
					};
				};

				// Print out in the console the object
				console.log(data);

				// Plotting begins
				var vis = d3.select("#visualisation1"),
			    WIDTH = 1000,
			    HEIGHT = 500,
			    MARGINS = {
			        top: 20,
			        right: 20,
			        bottom: 20,
			        left: 50
			    },
			    xScale = d3.scaleLinear().range([MARGINS.left, WIDTH - MARGINS.right]).domain([xmin,xmax]),
			    yScale = d3.scaleLinear().range([HEIGHT - MARGINS.top, MARGINS.bottom]).domain([ymin,ymax]),
			    xAxis = d3.axisBottom()
				    .scale(xScale),
				  
				yAxis = d3.axisLeft()
				    .scale(yScale);
					// .orient("left");

				vis.append("svg:g")
				    .attr("transform", "translate(0," + (HEIGHT - MARGINS.bottom) + ")")
				    .call(xAxis);

				vis.append("svg:g")
				    .attr("transform", "translate(" + (MARGINS.left) + ",0)")
				    .call(yAxis);

				vis.append("text")
				    .attr("class", "x label")
				    .attr("text-anchor", "end")
				    .attr("x", WIDTH-20)
				    .attr("y", HEIGHT-25)
				    .text("Year");

				vis.append("text")
				    .attr("class", "y label")
				    .attr("text-anchor", "end")
				    .attr("y", 65)
				    .attr("x", -20)
				    //.attr("dy", ".75em")
				    .attr("transform", "rotate(-90)")
				    .text("Temperature Â°C");

				var lineGen = d3.line()
				  .x(function(d) {
				    return xScale(d.year);
				  })
				  .y(function(d) {
				    return yScale(d.temperature);
				  });

				vis.append('svg:path')
				  .attr('d', lineGen(data))
				  .attr('stroke', 'green')
				  .attr('stroke-width', 2)
				  .attr('fill', 'none');


			}
		});

	</script>
</html>